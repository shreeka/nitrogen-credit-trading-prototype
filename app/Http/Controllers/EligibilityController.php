<?php

namespace App\Http\Controllers;

use Illuminate\Http\Request;
use Illuminate\Support\Facades\File;
use Illuminate\Support\Facades\Http;

class EligibilityController extends Controller
{
    public function getBalance()
    {
/*        $exampleDataF1 = [
            "input" => [
                "soil_texture" => "sand",
                "tilled" => "yes",
                "pH" => "7",
                "CEC" => "30",
                "SOM" => "1.5",
                "depth_s" => "0.3",
                "stony" => "0.15",
                "N_NH4" => "0.2",
                "mineralizationSlowdown" => "10",
                "Pc_method" => "olsen",
                "Pc_s" => "10",
                "Kc_s" => "30",
                "Nc_s_initial" => "30",
                "crop_type" => "BARLEY_6_ROW",
                "PK_strategy" => "minimum-fertilizer",
                "crop_startDate" => "2015-01-11",
                "crop_endDate" => "2015-06-11",
                "yield" => "10000",
                "Nc_h" => "1.6",
                "Pc_h" => "0.42",
                "Kc_h" => "0.54",
                "export_r" => "100",
                "HI_est" => "40",
                "CV" => "20",
                "climatic_zone" => "continental",
                "dose_irrigation" => "4000",
                "water_supply" => "1",
                "type_irrigated" => "sprinkler",
                "waterNitrate" => "15",
                "applications" => [
                    [
                        "type" => "U",
                        "date" => "2021-09-07",
                        "amount" => "15",
                        "name" => "Urea",
                        "N" => "46",
                        "P" => "0",
                        "K" => "0"
                    ]
                ],
                "prices" => [
                    [
                        "ID",
                        "Fertilizer",
                        "Price (euro/t)"
                    ],
                    [
                        "NaN",
                        "Sodium nitrate",
                        "100000"
                    ],
                    [
                        "CaN",
                        "Calcium nitrate",
                        "100000"
                    ],
                    [
                        "MgN",
                        "Magnesium nitrate",
                        "280"
                    ],
                    [
                        "AumS",
                        "Ammonium sulphate",
                        "215"
                    ],
                    [
                        "U",
                        "Urea",
                        "305"
                    ],
                    [
                        "AumN",
                        "Ammonium nitrate",
                        "275"
                    ]
                ],
                "Clima" => [
                    [
                        "Fecha",
                        "Tm (ºC)",
                        "TMA (ºC)",
                        "tma (ºC)",
                        "Hr (%)",
                        "Hrmax (%)",
                        "Hrmin (%)",
                        "RS (MJ/m²)",
                        "V (m/s)",
                        "VMA (m/s)",
                        "HS (horas)",
                        "P (mm)",
                        "ETo (mm)"
                    ],
                    [
                        "2015-01-01",
                        "11.7",
                        "15.8",
                        "8.2",
                        "86.2",
                        "96.5",
                        "68.1",
                        "4.83",
                        "1.9",
                        "7.3",
                        "5.3",
                        "0",
                        "1"
                    ],
                    [
                        "2015-01-02",
                        "8.8",
                        "12.8",
                        "3.7",
                        "76.7",
                        "92.4",
                        "55.3",
                        "6.26",
                        "4.8",
                        "10.5",
                        "6.5",
                        "0",
                        "1.7"
                    ],
                    [
                        "2015-01-03",
                        "8.6",
                        "12.7",
                        "1.8",
                        "82.9",
                        "94.7",
                        "66.7",
                        "4.23",
                        "5.6",
                        "12.9",
                        "5.5",
                        "0",
                        "1.4"
                    ],
                    [
                        "2015-01-04",
                        "13.8",
                        "18.3",
                        "9",
                        "73.5",
                        "93.2",
                        "53.8",
                        "8.17",
                        "9.5",
                        "17.5",
                        "6.9",
                        "0.8",
                        "2.9"
                    ],
                    [
                        "2015-01-05",
                        "6.6",
                        "9.6",
                        "2.7",
                        "85.9",
                        "95.4",
                        "63.8",
                        "6.57",
                        "5.6",
                        "12.5",
                        "5",
                        "3.9",
                        "1.3"
                    ],
                    [
                        "2015-01-06",
                        "4.5",
                        "8.3",
                        "0.3",
                        "84.8",
                        "95.4",
                        "74.1",
                        "6.54",
                        "5.9",
                        "13",
                        "7.9",
                        "0.2",
                        "1"
                    ],
                    [
                        "2015-01-07",
                        "10.8",
                        "13.9",
                        "8.6",
                        "84",
                        "88.9",
                        "73.8",
                        "5.18",
                        "6.3",
                        "12.6",
                        "4.8",
                        "0",
                        "1.5"
                    ],
                    [
                        "2015-01-08",
                        "11.1",
                        "14.7",
                        "7.6",
                        "78.4",
                        "94.4",
                        "58.2",
                        "7.59",
                        "4.4",
                        "10.7",
                        "6.5",
                        "0",
                        "1.7"
                    ],
                    [
                        "2015-01-09",
                        "10.5",
                        "13.9",
                        "7.1",
                        "80.4",
                        "94.5",
                        "55.8",
                        "6.83",
                        "4.6",
                        "11.5",
                        "6.2",
                        "1.4",
                        "1.7"
                    ],
                    [
                        "2015-01-10",
                        "10.5",
                        "13.9",
                        "7.8",
                        "75.5",
                        "84.3",
                        "60.6",
                        "7.19",
                        "6.2",
                        "12.2",
                        "6.9",
                        "0",
                        "2"
                    ],
                    [
                        "2015-01-11",
                        "9.1",
                        "11.7",
                        "4.6",
                        "81.2",
                        "94.6",
                        "75.5",
                        "3.27",
                        "6.2",
                        "13",
                        "4.9",
                        "2.5",
                        "1.1"
                    ],
                    [
                        "2015-01-12",
                        "4.2",
                        "9.5",
                        "-0.5",
                        "85.6",
                        "98.2",
                        "63.5",
                        "9.9",
                        "2.7",
                        "8.5",
                        "7.7",
                        "0",
                        "1"
                    ],
                    [
                        "2015-01-13",
                        "2.8",
                        "10.9",
                        "-2.7",
                        "88",
                        "100",
                        "55.2",
                        "8.14",
                        "0.8",
                        "3",
                        "7.3",
                        "0.2",
                        "0.7"
                    ],
                    [
                        "2015-01-14",
                        "5.3",
                        "12.6",
                        "-2.2",
                        "86.6",
                        "99.4",
                        "55.5",
                        "6.46",
                        "1.9",
                        "8.4",
                        "6.9",
                        "1.4",
                        "1.1"
                    ],
                    [
                        "2015-01-15",
                        "6.1",
                        "9.8",
                        "0.3",
                        "84.2",
                        "100",
                        "54.9",
                        "5.58",
                        "3.2",
                        "9.4",
                        "5.9",
                        "2.2",
                        "1.2"
                    ],
                    [
                        "2015-01-16",
                        "1.6",
                        "7.4",
                        "-1.8",
                        "75.8",
                        "92.4",
                        "44.8",
                        "10.81",
                        "3.8",
                        "7.9",
                        "8",
                        "0",
                        "1.4"
                    ],
                    [
                        "2015-01-17",
                        "1",
                        "8.6",
                        "-5.6",
                        "76.9",
                        "93.6",
                        "48.3",
                        "9.75",
                        "1.8",
                        "4.2",
                        "7.9",
                        "0",
                        "1"
                    ],
                    [
                        "2015-01-18",
                        "5.8",
                        "11.7",
                        "-0.5",
                        "77.2",
                        "92",
                        "58.3",
                        "7.06",
                        "4.7",
                        "13.3",
                        "7.1",
                        "0",
                        "1.6"
                    ],
                    [
                        "2015-01-19",
                        "3.9",
                        "9",
                        "-0.7",
                        "92",
                        "100",
                        "72.7",
                        "6.15",
                        "1.9",
                        "5.2",
                        "6.6",
                        "0.2",
                        "0.8"
                    ],
                    [
                        "2015-01-20",
                        "4.3",
                        "9.6",
                        "-0.9",
                        "91.3",
                        "100",
                        "73",
                        "7.06",
                        "1.8",
                        "5.4",
                        "6.6",
                        "0.2",
                        "0.8"
                    ],
                    [
                        "2015-01-21",
                        "6.9",
                        "10.5",
                        "4",
                        "88.7",
                        "97.8",
                        "74.9",
                        "8.9",
                        "2.7",
                        "6.6",
                        "7.7",
                        "0",
                        "0.9"
                    ],
                    [
                        "2015-01-22",
                        "9",
                        "13.1",
                        "4.8",
                        "91.9",
                        "99.9",
                        "79.2",
                        "4.78",
                        "1.6",
                        "5.2",
                        "5.8",
                        "0.2",
                        "0.8"
                    ],
                    [
                        "2015-01-23",
                        "8.2",
                        "17",
                        "2.5",
                        "91",
                        "100",
                        "60.8",
                        "8.26",
                        "1.5",
                        "4.9",
                        "7.3",
                        "0.2",
                        "1.2"
                    ],
                    [
                        "2015-01-24",
                        "9.3",
                        "18.8",
                        "0.8",
                        "83.3",
                        "100",
                        "51",
                        "11.15",
                        "2.1",
                        "6.5",
                        "8.2",
                        "0.2",
                        "1.7"
                    ],
                    [
                        "2015-01-25",
                        "8.6",
                        "15.7",
                        "5.1",
                        "89.7",
                        "100",
                        "60.8",
                        "7.95",
                        "1.4",
                        "4",
                        "6.9",
                        "0.2",
                        "1.1"
                    ],
                    [
                        "2015-01-26",
                        "7.3",
                        "13.6",
                        "2.9",
                        "89.4",
                        "100",
                        "65.2",
                        "8.17",
                        "1",
                        "3.9",
                        "6.5",
                        "0",
                        "0.9"
                    ],
                    [
                        "2015-01-27",
                        "6.4",
                        "12.6",
                        "2",
                        "94.6",
                        "100",
                        "73.1",
                        "7.27",
                        "1.4",
                        "6.4",
                        "7.1",
                        "0.4",
                        "0.9"
                    ],
                    [
                        "2015-01-28",
                        "6.4",
                        "13.5",
                        "-0.3",
                        "86.7",
                        "100",
                        "60",
                        "9.16",
                        "1.2",
                        "5.3",
                        "7.1",
                        "0",
                        "1"
                    ],
                    [
                        "2015-01-29",
                        "7.4",
                        "10.4",
                        "4.6",
                        "93.2",
                        "99.4",
                        "83.8",
                        "2.77",
                        "2.4",
                        "6.5",
                        "3",
                        "1.4",
                        "0.7"
                    ],
                    [
                        "2015-01-30",
                        "6.1",
                        "12.1",
                        "0.5",
                        "91.5",
                        "100",
                        "69.8",
                        "9.73",
                        "2",
                        "6.7",
                        "7.2",
                        "0",
                        "1"
                    ],
                    [
                        "2015-01-31",
                        "7.4",
                        "13.7",
                        "1.3",
                        "86.1",
                        "100",
                        "61.4",
                        "10.72",
                        "3.6",
                        "9.2",
                        "8",
                        "0.2",
                        "1.5"
                    ],
                    [
                        "2015-02-01",
                        "7.4",
                        "15.2",
                        "1.5",
                        "86.4",
                        "100",
                        "54.6",
                        "11.87",
                        "1.9",
                        "5.2",
                        "8.3",
                        "0",
                        "1.5"
                    ],
                    [
                        "2015-02-02",
                        "6.7",
                        "17.2",
                        "-1.8",
                        "86.8",
                        "100",
                        "53.8",
                        "10.8",
                        "1.5",
                        "6.4",
                        "7.6",
                        "0.2",
                        "1.5"
                    ],
                    [
                        "2015-02-03",
                        "6.6",
                        "13.9",
                        "0.9",
                        "82.7",
                        "100",
                        "54.6",
                        "10.36",
                        "2.1",
                        "5.4",
                        "8.2",
                        "0.2",
                        "1.4"
                    ],
                    [
                        "2015-02-04",
                        "4.4",
                        "12.5",
                        "-3.2",
                        "74.6",
                        "95.9",
                        "40.3",
                        "13.28",
                        "1.7",
                        "7.4",
                        "8.8",
                        "0",
                        "1.5"
                    ]
                ],
                "Meteo" => [
                    [
                        "Fecha",
                        "Tm (ºC)",
                        "TMA (ºC)",
                        "tma (ºC)",
                        "Hr (%)",
                        "Hrmax (%)",
                        "Hrmin (%)",
                        "RS (MJ/m²)",
                        "V (m/s)",
                        "VMA (m/s)",
                        "HS (horas)",
                        "P (mm)",
                        "ETo (mm)"
                    ],
                    [
                        "01/01/2015",
                        "1",
                        "10.3",
                        "-6.8",
                        "77.1",
                        "94.4",
                        "52.9",
                        "10.23",
                        "1.2",
                        "4.3",
                        "7.9",
                        "0",
                        "0.8"
                    ],
                    [
                        "02/01/2015",
                        "1.6",
                        "13.9",
                        "-5.7",
                        "72.2",
                        "96.9",
                        "28.9",
                        "10.19",
                        "0.9",
                        "4.3",
                        "7.7",
                        "0",
                        "1"
                    ],
                    [
                        "03/01/2015",
                        "2.6",
                        "15.2",
                        "-5.3",
                        "69.9",
                        "93.9",
                        "26.2",
                        "10.44",
                        "1.7",
                        "5.1",
                        "7.8",
                        "0",
                        "1.6"
                    ],
                    [
                        "04/01/2015",
                        "4.6",
                        "15.8",
                        "-2.9",
                        "65",
                        "90.8",
                        "29.2",
                        "10.2",
                        "1.8",
                        "5.7",
                        "7.8",
                        "0",
                        "1.7"
                    ],
                    [
                        "05/01/2015",
                        "3.7",
                        "15.2",
                        "-3.5",
                        "71.1",
                        "93.9",
                        "32.3",
                        "10.24",
                        "0.8",
                        "2.9",
                        "7.9",
                        "0",
                        "0.9"
                    ],
                    [
                        "06/01/2015",
                        "2.7",
                        "12",
                        "-3.8",
                        "73.2",
                        "94.3",
                        "39",
                        "10.19",
                        "2",
                        "6.7",
                        "7.7",
                        "0",
                        "1.3"
                    ],
                    [
                        "07/01/2015",
                        "1.3",
                        "10.6",
                        "-5.7",
                        "82.6",
                        "96.6",
                        "56.8",
                        "9.93",
                        "0.9",
                        "4.5",
                        "7.8",
                        "0",
                        "0.7"
                    ],
                    [
                        "08/01/2015",
                        "1.2",
                        "12.2",
                        "-6",
                        "83.4",
                        "100",
                        "46.8",
                        "9.77",
                        "0.9",
                        "3.9",
                        "7.3",
                        "0",
                        "0.8"
                    ],
                    [
                        "09/01/2015",
                        "2.7",
                        "14.5",
                        "-6.5",
                        "70.5",
                        "96.5",
                        "29.2",
                        "10.6",
                        "1",
                        "3.6",
                        "7.8",
                        "0.2",
                        "1.1"
                    ],
                    [
                        "10/01/2015",
                        "3.4",
                        "17.2",
                        "-5.7",
                        "71.3",
                        "96.8",
                        "24.3",
                        "10.84",
                        "1.7",
                        "5",
                        "7.9",
                        "0",
                        "1.8"
                    ],
                    [
                        "11/01/2015",
                        "5",
                        "15.3",
                        "-3.4",
                        "72.3",
                        "92.5",
                        "40",
                        "10.41",
                        "2.4",
                        "7.3",
                        "7.7",
                        "0",
                        "1.8"
                    ],
                    [
                        "12/01/2015",
                        "5.5",
                        "13.3",
                        "-1.6",
                        "82",
                        "100",
                        "57",
                        "9.39",
                        "2.5",
                        "7",
                        "7.3",
                        "0",
                        "1.3"
                    ],
                    [
                        "13/01/2015",
                        "6.8",
                        "15.4",
                        "-0.7",
                        "75",
                        "99.9",
                        "42.2",
                        "10.21",
                        "1.2",
                        "5.3",
                        "7.8",
                        "0",
                        "1.1"
                    ],
                    [
                        "14/01/2015",
                        "4.5",
                        "14.4",
                        "-2.2",
                        "75.9",
                        "97",
                        "46.6",
                        "10.18",
                        "1.2",
                        "4.2",
                        "7.8",
                        "0",
                        "1.1"
                    ],
                    [
                        "15/01/2015",
                        "6.6",
                        "15.9",
                        "-3",
                        "71.2",
                        "95.5",
                        "36.9",
                        "10.37",
                        "2.4",
                        "9",
                        "7.7",
                        "0",
                        "1.8"
                    ],
                    [
                        "16/01/2015",
                        "6.3",
                        "9.2",
                        "1.3",
                        "71.3",
                        "89.1",
                        "46",
                        "7.34",
                        "5",
                        "11.9",
                        "5.6",
                        "0.6",
                        "1.8"
                    ],
                    [
                        "17/01/2015",
                        "1.3",
                        "7.7",
                        "-5",
                        "75.2",
                        "97.9",
                        "44.1",
                        "11.08",
                        "3.4",
                        "8.8",
                        "8",
                        "0",
                        "1.4"
                    ],
                    [
                        "18/01/2015",
                        "-0.4",
                        "3.8",
                        "-6.9",
                        "89.7",
                        "99.7",
                        "62.2",
                        "4.12",
                        "1.1",
                        "3.8",
                        "6.8",
                        "4.1",
                        "0.6"
                    ],
                    [
                        "19/01/2015",
                        "3.2",
                        "6.9",
                        "-0.5",
                        "87.4",
                        "100",
                        "59.8",
                        "3.81",
                        "3",
                        "7.7",
                        "5.3",
                        "2.4",
                        "1"
                    ],
                    [
                        "20/01/2015",
                        "1.1",
                        "6.4",
                        "-2.1",
                        "81",
                        "96.2",
                        "53.5",
                        "9.98",
                        "3",
                        "8.3",
                        "7.6",
                        "0",
                        "1.1"
                    ],
                    [
                        "21/01/2015",
                        "1.5",
                        "6.6",
                        "-2.4",
                        "88.3",
                        "99.1",
                        "59.8",
                        "7.6",
                        "4.5",
                        "11.4",
                        "6.6",
                        "0.2",
                        "1.1"
                    ],
                    [
                        "22/01/2015",
                        "2.2",
                        "5.9",
                        "-0.5",
                        "84.8",
                        "95.7",
                        "66.9",
                        "5.28",
                        "5.1",
                        "11.4",
                        "6.2",
                        "0",
                        "1"
                    ],
                    [
                        "23/01/2015",
                        "2.2",
                        "8.3",
                        "-2.3",
                        "72.5",
                        "92.1",
                        "45.5",
                        "12.08",
                        "5.3",
                        "12.5",
                        "8.4",
                        "0",
                        "1.8"
                    ],
                    [
                        "24/01/2015",
                        "1.9",
                        "10.5",
                        "-4",
                        "66.8",
                        "89.3",
                        "29.8",
                        "11.03",
                        "4.1",
                        "10.1",
                        "8.5",
                        "0",
                        "2.2"
                    ],
                    [
                        "25/01/2015",
                        "5.7",
                        "12.9",
                        "0.3",
                        "54.3",
                        "84.6",
                        "21.2",
                        "12.39",
                        "5.6",
                        "10.4",
                        "8.7",
                        "0",
                        "3.2"
                    ],
                    [
                        "26/01/2015",
                        "3.3",
                        "12.5",
                        "-5.1",
                        "60.7",
                        "88.1",
                        "34.9",
                        "12.07",
                        "2.3",
                        "6.5",
                        "8.3",
                        "0",
                        "1.8"
                    ],
                    [
                        "27/01/2015",
                        "5.1",
                        "12.9",
                        "-2.8",
                        "69.8",
                        "92.8",
                        "45.1",
                        "12.07",
                        "4.2",
                        "10.1",
                        "8.5",
                        "0",
                        "2.1"
                    ],
                    [
                        "28/01/2015",
                        "5",
                        "12.9",
                        "-0.7",
                        "67.8",
                        "89.1",
                        "38.6",
                        "12.86",
                        "4.2",
                        "10.2",
                        "8.6",
                        "0",
                        "2.3"
                    ],
                    [
                        "29/01/2015",
                        "6.3",
                        "13.5",
                        "-2.8",
                        "75",
                        "96.9",
                        "44.8",
                        "11.09",
                        "5.4",
                        "14.9",
                        "8.1",
                        "0",
                        "2.3"
                    ],
                    [
                        "30/01/2015",
                        "11.9",
                        "15.3",
                        "9.7",
                        "78.5",
                        "89.1",
                        "62.9",
                        "8.73",
                        "11",
                        "18.3",
                        "7.2",
                        "0.2",
                        "2.5"
                    ],
                    [
                        "31/01/2015",
                        "7.3",
                        "12.1",
                        "1.1",
                        "75.9",
                        "96.5",
                        "55.5",
                        "12.34",
                        "9.7",
                        "18.2",
                        "8.1",
                        "11.2",
                        "2.2"
                    ],
                    [
                        "01/02/2015",
                        "2.3",
                        "6.8",
                        "-0.2",
                        "72.3",
                        "84.8",
                        "47.7",
                        "11.34",
                        "6.9",
                        "14.1",
                        "8.7",
                        "0",
                        "1.9"
                    ],
                    [
                        "02/02/2015",
                        "2.5",
                        "6.4",
                        "-1.9",
                        "85.2",
                        "94.1",
                        "70.7",
                        "6.33",
                        "4.1",
                        "13.7",
                        "6.7",
                        "0.6",
                        "1"
                    ],
                    [
                        "03/02/2015",
                        "6.2",
                        "10.5",
                        "3.8",
                        "79.8",
                        "92.2",
                        "56.1",
                        "11.11",
                        "7.2",
                        "13.1",
                        "8.5",
                        "1.2",
                        "2"
                    ],
                    [
                        "04/02/2015",
                        "0.6",
                        "4.2",
                        "-1.9",
                        "84.3",
                        "100",
                        "58.9",
                        "9.91",
                        "7.1",
                        "14.4",
                        "7.5",
                        "3.7",
                        "1.2"
                    ]
                ],
                "Riegos" => [
                    [
                        "09/03/2015",
                        "10.8"
                    ],
                    [
                        "25/03/2015",
                        "10.8"
                    ],
                    [
                        "28/03/2015",
                        "10.8"
                    ],
                    [
                        "30/03/2015",
                        "10.8"
                    ],
                    [
                        "03/04/2015",
                        "10.8"
                    ],
                    [
                        "08/04/2015",
                        "10.8"
                    ],
                    [
                        "15/04/2015",
                        "10.8"
                    ],
                    [
                        "17/04/2015",
                        "10.8"
                    ],
                    [
                        "25/04/2015",
                        "10.8"
                    ],
                    [
                        "30/04/2015",
                        "10.8"
                    ],
                    [
                        "04/05/2015",
                        "10.8"
                    ],
                    [
                        "08/05/2015",
                        "10.8"
                    ],
                    [
                        "11/05/2015",
                        "14"
                    ],
                    [
                        "14/05/2015",
                        "14"
                    ],
                    [
                        "16/05/2015",
                        "18"
                    ],
                    [
                        "20/05/2015",
                        "18"
                    ],
                    [
                        "22/05/2015",
                        "18"
                    ],
                    [
                        "24/05/2015",
                        "21"
                    ],
                    [
                        "30/05/2015",
                        "21"
                    ],
                    [
                        "02/06/2015",
                        "14"
                    ],
                    [
                        "05/06/2015",
                        "10.8"
                    ],
                    [
                        "08/06/2015",
                        "10.8"
                    ]
                ],
                "NDVItipo" => [
                    [
                        "2015-01-05",
                        "0.187247"
                    ],
                    [
                        "2015-01-14",
                        "0.213159"
                    ],
                    [
                        "2015-03-10",
                        "0.296463"
                    ],
                    [
                        "2015-04-20",
                        "0.637953"
                    ],
                    [
                        "2015-05-06",
                        "0.803069"
                    ],
                    [
                        "2015-05-22",
                        "0.831533"
                    ],
                    [
                        "2015-06-07",
                        "0.707779"
                    ],
                    [
                        "2015-06-22",
                        "0.320279"
                    ],
                    [
                        "2015-06-30",
                        "0.319103"
                    ],
                    [
                        "2015-07-09",
                        "0.304515"
                    ]
                ],
                "NDVIreal" => [
                    [
                        "2015-01-05",
                        "0.237407406666667"
                    ],
                    [
                        "2015-01-14",
                        "0.262098764444444"
                    ],
                    [
                        "2015-03-03",
                        "0.256913580000000"
                    ],
                    [
                        "2015-03-10",
                        "0.281481481111111"
                    ],
                    [
                        "2015-04-20",
                        "0.817283951111111"
                    ],
                    [
                        "2015-05-06",
                        "0.877283950000000"
                    ],
                    [
                        "2015-05-22",
                        "0.884444443333333"
                    ],
                    [
                        "2015-06-07",
                        "0.824320987777778"
                    ],
                    [
                        "2015-06-23",
                        "0.368888887777778"
                    ],
                    [
                        "2015-06-30",
                        "0.340864197777778"
                    ],
                    [
                        "2015-07-09",
                        "0.302716048888889"
                    ],
                    [
                        "2015-07-16",
                        "0.303950617777778"
                    ],
                    [
                        "2015-07-25",
                        "0.295432098888889"
                    ]
                ],
                "FenoBBCH" => [
                    [
                        "2015-02-29",
                        "13"
                    ],
                    [
                        "2015-03-14",
                        "22"
                    ],
                    [
                        "2015-04-04",
                        "30"
                    ],
                    [
                        "2015-04-19",
                        "33"
                    ],
                    [
                        "2015-05-02",
                        "41"
                    ],
                    [
                        "2015-05-16",
                        "59"
                    ],
                    [
                        "2015-05-23",
                        "65"
                    ],
                    [
                        "2015-06-10",
                        "83"
                    ],
                    [
                        "2015-06-20",
                        "83"
                    ],
                    [
                        "2015-07-04",
                        "89"
                    ]
                ]
            ]
        ];*/


        $exampleDataF4 = [
            "input" => [
                "area" => 99,
                "comnbustible" => "Fuel oil",
                "drain_rate" => "",
                "consumption" => "1",
                "residues" => "incorporated",
                "spread" => "yes",
                "removed" => "no",
                "seeds" => "1000",
                "herb" => "2",
                "fung" => "3",
                "insect" => "0",
                "otreat" => "0",
                "temp_reg" => "temperate boreal",
                "moist_reg" => null,
                "soil" => null,
                "price" => null,
                "price_water" => null,
                "dose_irrigation" => "2500",
                "price_seeds" => null,
                "price_herb" => null,
                "price_fung" => null,
                "price_insect" => null,
                "price_otreat" => null,
                "crop_name" => "Barley 6 row",
                "crop_type" => "BARLEY_6_ROW",
                "PK_strategy" => "minimum-fertilizer",
                "yield" => 10000,
                "export_r" => "100",
                "HI_est" => "40",
                "CV" => "20",
                "Nc_h" => "1.6",
                "Pc_h" => "0.42",
                "Kc_h" => "0.54",
                "soil_texture" => "sand",
                "tilled" => "yes",
                "pH" => "7",
                "CEC" => "75",
                "SOM" => "1.5",
                "depth_s" => "0.3",
                "Nc_s_initial" => "30",
                "Nc_end" => "20",
                "Pc_method" => "olsen",
                "Pc_s" => "100",
                "Kc_s" => "10",
                "climatic_zone" => "alpine",
                "water_supply" => "1",
                "type_irrigated" => "sprinkler",
                "Nc_NO3_water" => "24",
                "rain_a" => "1000",
                "rain_w" => "600",
                "applied" => [
                    [
                        "fertilizerID" => "U",
                        "fertilizer_name" => "Urea",
                        "type" => "Inorganic",
                        "nbf" => 31.660404999755,
                        "amount" => 30,
                        "cost" => 9.15,
                        "method" => "topdressing",
                        "frequency" => "annual",
                        "N" => 46,
                        "P" => 0,
                        "P2O5" => 0,
                        "K" => 0,
                        "K2O" => 0,
                        "S" => 0,
                        "N_ur" => 46
                    ]
                ],
                "prices" => [
                    [
                        "ID",
                        "Fertilizer",
                        "Price (euro/t)"
                    ],
                    [
                        "NaN",
                        "Sodium nitrate",
                        "100000"
                    ],
                    [
                        "CaN",
                        "Calcium nitrate",
                        "100000"
                    ],
                    [
                        "MgN",
                        "Magnesium nitrate",
                        "280"
                    ],
                    [
                        "AumS",
                        "Ammonium sulphate",
                        "215"
                    ],
                    [
                        "U",
                        "Urea",
                        "305"
                    ],
                    [
                        "AumN",
                        "Ammonium nitrate",
                        "275"
                    ],
                    [
                        "CaAumN",
                        "Calcium ammonium nitrate",
                        "301"
                    ],
                    [
                        "NSAum",
                        "Ammonium nitrosulphate",
                        "247"
                    ],
                    [
                        "N32",
                        "Nitrogen solutions (32%)",
                        "325"
                    ],
                    [
                        "Uf",
                        "Urea formaldehyde (UF)",
                        "100000"
                    ],
                    [
                        "Ibdu",
                        "Isobutylidene diurea (IBDU)",
                        "100000"
                    ],
                    [
                        "Cdu",
                        "Crotonylidene diurea (CDU)",
                        "100000"
                    ],
                    [
                        "sPsi",
                        "Superphosphate simple",
                        "273"
                    ],
                    [
                        "sPco",
                        "Superphosphate concentrate",
                        "202"
                    ],
                    [
                        "TSP",
                        "Triple superphosphate (TSP)",
                        "320"
                    ],
                    [
                        "Pac",
                        "Phosphoric acid",
                        "641"
                    ],
                    [
                        "sPac",
                        "Superphosphoric acid",
                        "100000"
                    ],
                    [
                        "DCaP",
                        "Dycalcium phosphate",
                        "100000"
                    ],
                    [
                        "CameP",
                        "Calcium metaphosphate",
                        "100000"
                    ],
                    [
                        "caP",
                        "Calcined phosphate",
                        "100000"
                    ],
                    [
                        "bs",
                        "Basic slags",
                        "100000"
                    ],
                    [
                        "gPr",
                        "Ground phosphate rock",
                        "100000"
                    ],
                    [
                        "KCl",
                        "Potassium chloride",
                        "365"
                    ],
                    [
                        "PS",
                        "Potassium sulphate",
                        "516"
                    ],
                    [
                        "MAP",
                        "Mono-ammonium phosphate (MAP)",
                        "548"
                    ],
                    [
                        "DAP",
                        "Di-ammonium phosphate (DAP)",
                        "411"
                    ],
                    [
                        "APP",
                        "Ammonium polyphosphates (APP)",
                        "100000"
                    ],
                    [
                        "NP",
                        "Nitrophosphates",
                        "100000"
                    ],
                    [
                        "KP",
                        "Potassium phosphates",
                        "100000"
                    ],
                    [
                        "KN",
                        "Potassium nitrate",
                        "550"
                    ],
                    [
                        "x8-15-15",
                        "Complex 8-15-15",
                        "281"
                    ],
                    [
                        "x12-12-24",
                        "Complex 12-12-24",
                        "371"
                    ],
                    [
                        "x15-15-15",
                        "Complex 15-15-15",
                        "349"
                    ],
                    [
                        "x9-18-27",
                        "Complex 9-18-27",
                        "357"
                    ],
                    [
                        "x8-24-8",
                        "Complex 8-24-8",
                        "325"
                    ],
                    [
                        "x8-24-16",
                        "Complex 8-24-16",
                        "341"
                    ],
                    [
                        "x12-24-8",
                        "Complex 12-24-8",
                        "315"
                    ],
                    [
                        "x12-24-12",
                        "Complex 12-24-12",
                        "320"
                    ],
                    [
                        "x9-12-24",
                        "Complex 9-12-24",
                        "100000"
                    ],
                    [
                        "x10-20-10",
                        "Complex 10-20-10",
                        "230"
                    ],
                    [
                        "x8-16-8",
                        "Complex 8-16-8",
                        "305"
                    ],
                    [
                        "x18-46-0",
                        "Complex 18-46-0",
                        "385"
                    ],
                    [
                        "x10-10-17",
                        "Complex 10-10-17",
                        "292"
                    ],
                    [
                        "x12-36-12",
                        "Complex 12-36-12",
                        "390"
                    ],
                    [
                        "s4-16-10",
                        "Suspension 4-16-10",
                        "270"
                    ],
                    [
                        "s5-10-10",
                        "Suspension 5-10-10",
                        "100000"
                    ],
                    [
                        "s5-20-5",
                        "Suspension 5-20-5",
                        "100000"
                    ],
                    [
                        "s6-12-16",
                        "Suspension 6-12-16",
                        "100000"
                    ],
                    [
                        "s6-16-10",
                        "Suspension 6-16-10",
                        "100000"
                    ],
                    [
                        "s10-20-0",
                        "Suspension 10-20-0",
                        "100000"
                    ],
                    [
                        "P7-15-6",
                        "Fosfoplus 7-15-6 + 5%S + 9% PHC",
                        "100000"
                    ],
                    [
                        "P8-8-10",
                        "Fosfoplus 8-8-10 + 5%S + 9% PHC",
                        "100000"
                    ],
                    [
                        "sP18",
                        "Superphosphate 18%",
                        "242"
                    ],
                    [
                        "sP45",
                        "Superphosphate 45%",
                        "320"
                    ],
                    [
                        "acP",
                        "Acid phosphoric",
                        "641"
                    ],
                    [
                        "U46",
                        "Urea 46%",
                        "345"
                    ],
                    [
                        "U46i",
                        "Urea 46%+ Inhibitor",
                        "100000"
                    ],
                    [
                        "U40S",
                        "Urea 40%+ Sulfur (YARA Sulfamid)",
                        "280"
                    ],
                    [
                        "AumNS26",
                        "Ammonium nitrophosphate 26%",
                        "290"
                    ],
                    [
                        "AumNS21",
                        "Ammonium nitrophosphate 21%",
                        "100000"
                    ],
                    [
                        "soN32",
                        "Solution N-32",
                        "240"
                    ],
                    [
                        "soN20",
                        "Solution N-20",
                        "175"
                    ],
                    [
                        "soN26",
                        "Solution N-26",
                        "100000"
                    ],
                    [
                        "CaNso",
                        "Calcium nitrate solution",
                        "920"
                    ],
                    [
                        "MgNso",
                        "Magnesium nitrate solution",
                        "100000"
                    ],
                    [
                        "N33",
                        "Nitro33",
                        "100000"
                    ],
                    [
                        "Nplus",
                        "Nitroplus",
                        "307"
                    ],
                    [
                        "Nac",
                        "Nitric acid",
                        "443"
                    ],
                    [
                        "AumN33",
                        "Ammonium nitrate 33%",
                        "450"
                    ],
                    [
                        "AumN27",
                        "Ammonium nitrate 27% (NAC)",
                        "255"
                    ],
                    [
                        "AumN20",
                        "Ammonium nitrate 20%",
                        "100000"
                    ],
                    [
                        "MgS",
                        "Magnesium sulfate",
                        "320"
                    ],
                    [
                        "AumS21",
                        "Ammonium sulfate 21%",
                        "238"
                    ],
                    [
                        "cm",
                        "Cow manure",
                        "100000"
                    ],
                    [
                        "dc",
                        "Dairy Cow",
                        "100000"
                    ],
                    [
                        "dh",
                        "Dairy Heifer",
                        "100000"
                    ],
                    [
                        "bc",
                        "Beef Cow",
                        "100000"
                    ],
                    [
                        "bf",
                        "Beef Feeder",
                        "100000"
                    ],
                    [
                        "bes",
                        "Beef Stocker",
                        "100000"
                    ],
                    [
                        "sm",
                        "Swine Manure",
                        "100000"
                    ],
                    [
                        "sf",
                        "Swine Finishing",
                        "100000"
                    ],
                    [
                        "sg",
                        "Swine Growing",
                        "100000"
                    ],
                    [
                        "sn",
                        "Swine Nursery",
                        "100000"
                    ],
                    [
                        "sgs",
                        "Swine Gestating sow",
                        "100000"
                    ],
                    [
                        "ss",
                        "Swine Sow and litter",
                        "100000"
                    ],
                    [
                        "pm",
                        "Poultry Manure",
                        "100000"
                    ],
                    [
                        "pl",
                        "Poultry Layer",
                        "100000"
                    ],
                    [
                        "pb",
                        "Poultry Broiler",
                        "100000"
                    ],
                    [
                        "pt",
                        "Poultry Turkey",
                        "100000"
                    ],
                    [
                        "pd",
                        "Poultry Duck",
                        "100000"
                    ],
                    [
                        "pg",
                        "Poultry Goose",
                        "100000"
                    ],
                    [
                        "oh",
                        "Other Horse",
                        "100000"
                    ],
                    [
                        "os",
                        "Other Sheep",
                        "100000"
                    ],
                    [
                        "og",
                        "Other Goat",
                        "100000"
                    ],
                    [
                        "or",
                        "Other Rabbit",
                        "100000"
                    ],
                    [
                        "d",
                        "Digestato",
                        "100000"
                    ],
                    [
                        "se",
                        "Sludge EDAR",
                        "100000"
                    ],
                    [
                        "ps",
                        "Poultry slurry",
                        "100000"
                    ],
                    [
                        "rs",
                        "Rabbit slurry",
                        "100000"
                    ],
                    [
                        "pigs",
                        "Pig slurry",
                        "100000"
                    ],
                    [
                        "cs",
                        "Cattle slurry",
                        "100000"
                    ],
                    [
                        ""
                    ]
                ]
            ]
        ];


        $path = public_path('assets/myFarm.json');
        $resultFromApi = File::json($path);

        $dataF4 = ['input' => $resultFromApi['crops'][0]];


        $url =   'http://navigator-dev.teledeteccionysig.es/F4/requirements';
        $response = Http::post($url, $exampleDataF4);
        $resultData = $response->json();
/*        $resultCollection = collect($resultData['results']);
        $totalNBal = $resultCollection->sum('N_mineral_soil');*/

        $nutrientBalanceData = $resultData['results'][0]['nutrient_requirements'];
        $fertiliserApplied = 250;
        $baselineNSurplus = 50;

        $totalInput = array_sum($nutrientBalanceData['Ninputs_terms']) + $fertiliserApplied;
        $totalOutput = array_sum($nutrientBalanceData['Noutputs_terms']);
        $nitrogenBal = $totalInput - $totalOutput;
        $credits = $baselineNSurplus - $nitrogenBal;


        return view('creditgenerate.balanceresult',
            ['balance' => $resultData['results'][0]['nutrient_requirements'],
                'totalInput' => $totalInput,
                'totalOutput' => $totalOutput,
                'fertiliserApplied' => $fertiliserApplied,
                'nitrogenBal' => $nitrogenBal,
                'baselineNSurplus' => $baselineNSurplus,
                'credits' => $credits

            ]);

    }

}





